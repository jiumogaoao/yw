/*! This is uglify test - 2016-01-04 */!function(a,b,c){b.control.set({name:"detail",par:["id"],fn:function(c){function d(){b.model.get("#head","headSimple","head",function(a){a.reflash(),a.show()})}function f(){b.model.get("#foot","footSimple","foot",function(a){a.show()})}function g(){p=m.price[0].price,b.model.get("#main","navSimple","nav",function(a){a.show(),a.reflash()}),b.model.get("#main","rootNavSimple","rootNav",function(a){var b={obj:_.indexBy(j,"id"),product:m};a.setResult(b),a.show(),a.reflash()}),b.model.get("#main","detailTopSimple","detailTop",function(d){function e(){r="",p=0,q="",a.each(m.price,function(b,c){var e=1;d.target.find(".priceFrame .selectPoint.hl").each(function(){(c.state[a(this).attr("gid")]!==a(this).attr("pid")||0===c.count)&&(e=0),e&&(r+=" "+a(this).find(".selectTitle").html())}),e&&(p=c.price,q=c.id,d.target.find("#priceChoose").html("￥"+p+"（降价通知）"))}),q||d.target.find("#priceChoose").html("该型号缺货")}d.setResult({product:m,shop:n}),d.show(),d.reflash(),d.target.find(".priceFrame .selectPoint").unbind("click").bind("click",function(){a(this).parents(".priceFrame").find(".selectPoint").removeClass("hl"),a(this).addClass("hl"),e()}),d.target.find(".priceFrame").each(function(){a(this).find(".selectPoint").first().click()}),d.target.find(".addBuyCard").unbind("click").bind("click",function(){o&&o.id?(e(),q&&p?(o.shopList||(o.shopList={}),o.shopList[c.id]={id:c.id,count:Number(d.target.find(".count input").val()),modelId:q,modelString:r},b.api.run("client_shopList",{tk:i,shopList:o.shopList},function(){b.pop.on("alert",{text:"添加成功"})},function(a){b.pop.on("alert",{text:JSON.stringify(a)})})):b.pop.on("alert",{text:"请先选择有效价格属性"})):(b.pop.on("alert",{text:"请先登录"}),b.hash("login"))}),d.target.find("#addCollect").unbind("click").bind("click",function(){o&&o.id&&(o.collectProduct||(o.collectProduct={}),o.collectProduct[c.id]=m,o.tk=i,b.api.run("client_collect",o,function(a){b.pop.on("alert",{text:"收藏成功"})},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}))})}),b.model.get("#main","detailCenterSimple","detailCenter",function(a){var b={shopRecommend:_.where(l,{shopId:m.shopId,recommend:"1"}),otherRecommend:_.filter(l,function(a){return a.object[a.object.length-1]===m.object[m.object.length-1]&&"1"===a.recommend})};a.setResult(b),a.show(),a.reflash()}),b.model.get("#main","detailBottomSimple","detailBottom",function(a){var b={type:[],brand:[],topShell:[],topVisit:[],topPrice:[],product:m};m.object[0]&&(b.type=_.where(j,{parentId:m.object[0]})),m.object[1]&&(b.brand=_.where(j,{parentId:m.object[1]})),b.topShell=_.sortBy(_.filter(l,function(a){return a.object[a.object.length-1]===m.object[m.object.length-1]}),function(a){return Math.sin(a.member.length)}),b.topVisit=_.sortBy(_.filter(l,function(a){return a.object[a.object.length-1]===m.object[m.object.length-1]}),function(a){return Math.sin(a.visit)}),b.topPrice=_.sortBy(_.filter(l,function(a){return a.object[a.object.length-1]===m.object[m.object.length-1]}),function(a){return Math.sin(a.price[0].price)}),a.setResult(b),a.show(),a.reflash()})}function h(a){i=a;var h=0,p=function(){h++,5===h&&(d(),f(),g())};b.api.run("type_get",{tk:i},function(a){k=a,p()},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}),b.api.run("obj_get",{tk:i},function(a){j=a,p()},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}),b.api.run("product_visit",{tk:i,id:c.id},function(a){p()},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}),b.api.run("tk_get",{tk:i},function(a){o=a.user,p()},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}),b.api.run("product_get",{tk:i},function(a){l=a,m=_.indexBy(l,"id")[c.id],b.api.run("client_getShop",{tk:i,id:m.shopId},function(a){n=a,p()},function(){b.pop.on("alert",{text:JSON.stringify(e)})})},function(a){b.pop.on("alert",{text:JSON.stringify(a)})})}var i="",j=[],k=[],l=[],m={},n={},o={},p=0,q="",r="";b.api.tk(h)}})}($,app,config);