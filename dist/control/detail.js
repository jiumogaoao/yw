/*! This is uglify test - 2015-11-08 */!function(a,b,c){b.control.set({name:"detail",par:["id"],fn:function(c){function d(){b.model.get("#head","headSimple","head",function(a){a.set({object:i,type:0}),a.reflash(),a.show()})}function e(){b.model.get("#foot","footPromo","footPromo",function(a){a.show()}),b.model.get("#foot","footSimple","foot",function(a){a.show()})}function f(){b.model.get("#main","seguesOne","segues",function(c){c.show(),c["goto"]("pageTwo",function(d,e){function f(){g++,1===g&&e()}d.clean();var g=0;b.model.get(d,"detailAll","detailAll",function(d){k.buy=0,k.user={},l&&l.id&&(k.user={balance:l.balance,redpacket:l.redpacket}),k.buildtypeArry=["农民房","商品房","商铺"],k.buildStateArry=["未建","在建","新房","二手房"];var e=(new Date).getTime();k.orderTime<e&&(k.stratTime>e?k.tag=0:k.stratTime<e&&k.payedCount>=k.passNumber&&k.payedCount<k.copy?k.tag=1:k.tag=2),d.set(k),d.refalsh(),d.target.find(".addCom").unbind("click").bind("click",function(){l&&l.id?b.model.get("#pop","moneyIn","pop",function(a){a.set({title:"添加评论",button:[{id:"comSend",text:"提交评论"}],list:[{name:"main",title:"内容",placeholder:"",type:"input",value:"",valuelabel:"",option:[{label:"",value:""}]}]}),a.reflash(),a.target.find("#comSend").unbind("click").bind("click",function(){var c=a.result();c.tk=h,c.userId=l.id,c.productId=k.id,c.userHead=l.image,c.userName=l.userName,b.api.run("com_add",c,function(){alert("评论成功"),window.location.reload()},function(a){alert(a)})}),a.show(),app.pop.show()}):alert("请先登录")}),d.target.find("#moneyIn").unbind("click").bind("click",function(){b.model.get("#pop","moneyIn","pop",function(a){a.set({title:"充值确认",button:[{id:"inSend",text:"确认充值"}],list:[{name:"number",title:"充值金额",placeholder:"",type:"number",value:"0",valuelabel:"",option:[{label:"",value:""}]}]}),a.reflash(),a.target.find("#inSend").unbind("click").bind("click",function(){var c=a.result();c.tk=h,b.api.run("money_in",c,function(){alert("充值成功"),window.location.reload()},function(a){alert(a)})}),a.show(),app.pop.show()})}),d.target.find("#buyButton").unbind("click").bind("click",function(){var a={id:uuid(),productId:k.id,userId:l.id,startTime:(new Date).getTime(),endTime:0,buyPrice:k.price,sellPrice:0,count:k.buy,tk:h};b.model.get("#pop","buy","pop",function(c){c.set({title:"买入确认",button:[{id:"buySend",text:"买入"}],list:[{name:"",title:"交易编码",placeholder:"",type:"simple",value:a.id,valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"商品编码",placeholder:"",type:"simple",value:a.productId,valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"商品名",placeholder:"",type:"simple",value:k.title,valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"买入价",placeholder:"",type:"simple",value:"￥"+a.buyPrice,valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"买入份数",placeholder:"",type:"simple",value:a.count,valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"买入时间",placeholder:"",type:"simple",value:moment(a.startTime,"x").format("YYYY-MM-DD"),valuelabel:"",option:[{label:"",value:""}]},{name:"",title:"合计金额",placeholder:"",type:"simple",value:"￥"+a.buyPrice*a.count,valuelabel:"",option:[{label:"",value:""}]}]}),c.reflash(),c.show(),c.target.find("#buySend").unbind("click").bind("click",function(){b.api.run("buy",a,function(){alert("购买成功"),app.pop.hide();var a=(new Date).getTime();k.stratTime>a?b.hash("orderManage/"+k.object):b.hash("dealManage/"+k.object)},function(a){alert(a)})}),app.pop.show()})}),d.target.find(".numSub").unbind("click").bind("click",function(){k.buy>1?(k.buy--,d.target.find(".numInput").val(k.buy),d.target.find("#buyButton").html("支持 ￥"+k.price*k.buy),d.target.find("#buyButton").show()):(k.buy=0,d.target.find(".numInput").val(k.buy),d.target.find("#buyButton").hide())}),d.target.find(".numAdd").unbind("click").bind("click",function(){var a=k.copy-k.payedCount<Math.floor(((k.user.balance||0)+(k.user.reckpacket||0))/k.price)?k.copy-k.payedCount:Math.floor(((k.user.balance||0)+(k.user.reckpacket||0))/k.price);k.buy<=a-1&&(k.buy++,d.target.find(".numInput").val(k.buy),d.target.find("#buyButton").html("支持 ￥"+k.price*k.buy),d.target.find("#buyButton").show())}),d.target.find(".numInput").unbind("change").bind("change",function(){var b=k.copy-k.payedCount<Math.floor(((k.user.balance||0)+(k.user.reckpacket||0))/k.price)?k.copy-k.payedCount:Math.floor(((k.user.balance||0)+(k.user.reckpacket||0))/k.price);k.buy=Number(a(this).val()),k.buy>b&&(k.buy=b),a(this).val(k.buy)}),d.show(),a("img").load(function(){c.reflash()}),f()})},{w:"100%"})})}function g(a){h=a;var g=0,m=function(){g++,4===g&&(d(),e(),f())};b.api.run("obj_get",{tk:h},function(a){i=_.indexBy(a,"id"),m()},function(a){alert(a)}),b.api.run("type_get",{tk:h},function(a){j=_.indexBy(a,"id"),m()},function(a){alert(a)}),b.api.run("product_detail",{tk:h,id:c.id},function(a){k=a,m()},function(a){alert(a)}),b.api.run("tk_get",{tk:h},function(a){l=a.user,m()},function(a){alert(a)})}var h="",i=[],j=[],k={},l={};b.api.tk(g)}})}($,app,config);